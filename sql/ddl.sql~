CREATE TABLE Room (
	RoomID INT NOT NULL AUTO_INCREMENT,
	Name VARCHAR(50),
	Capacity INT,
	Floor INT,
	PRIMARY KEY (RoomID)
) ENGINE = INNODB;

CREATE TABLE Type (
	TypeID INT NOT NULL AUTO_INCREMENT,
	Facility VARCHAR(100),
	PRIMARY KEY(TypeID)
) ENGINE = INNODB;

CREATE TABLE RoomType (
	RoomID INT,
	TypeID INT,
	FOREIGN KEY(RoomID) REFERENCES Room(RoomID) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(TypeID) REFERENCES Type(TypeID) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY (RoomID,TypeID)
) ENGINE = INNODB;

CREATE TABLE Building (
	BuildingID INT NOT NULL AUTO_INCREMENT,
	BuildingName VARCHAR(50),
	Latitude FLOAT,
	Longitude FLOAT,
	PRIMARY KEY(BuildingID)
) ENGINE = INNODB;

CREATE TABLE Module (
	ModuleCode VARCHAR(20),
	ModuleName VARCHAR(100),
	PRIMARY KEY(ModuleCode)
) ENGINE = INNODB;

CREATE TABLE Course (
	CourseCode VARCHAR(20),
	CourseName VARCHAR(100),
	Year INT,
	PRIMARY KEY(CourseCode)
) ENGINE = INNODB;

CREATE TABLE ModuleGroup(
	GroupID INT NOT NULL AUTO_INCREMENT,
	GroupCode VARCHAR(6),
	ModuleCode VARCHAR(20),
	ActivityType VARCHAR(50),
	FOREIGN KEY(ModuleCode) REFERENCES Module(ModuleCode) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY(GroupID)
);

CREATE TABLE Staff (
	StaffID INT NOT NULL AUTO_INCREMENT,
	Username VARCHAR(20),
	Name VARCHAR(50),
	Level VARCHAR(50),
	PRIMARY KEY (StaffID)
) ENGINE = INNODB;

CREATE TABLE StaffGroup (
	GroupID INT,
	StaffID INT,
	FOREIGN KEY(StaffID) REFERENCES Staff(StaffID) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(GroupID) REFERENCES ModuleGroup(GroupID) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY(GroupID, StaffID)
) ENGINE = INNODB;

CREATE TABLE Student (
	StudentID INT AUTO_INCREMENT,
	CourseCode VARCHAR(20),
	Name VARCHAR(50),
	Username VARCHAR(20) UNIQUE,
	FOREIGN KEY(CourseCode) REFERENCES Course(CourseCode) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY(StudentID)
) ENGINE = INNODB;

CREATE TABLE StudentGroup (
	StudentID INT,
	GroupID INT, 
	FOREIGN KEY(GroupID) REFERENCES ModuleGroup(GroupID) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(StudentID) REFERENCES Student(StudentID) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY (StudentID, GroupID)
) ENGINE = INNODB;

CREATE TABLE StaffBio (
	BioID INT AUTO_INCREMENT,
	StaffID	INT,
	Bio TEXT,
	FOREIGN KEY(StaffID) REFERENCES Staff(StaffID) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY(BioID)
) ENGINE = INNODB;

CREATE TABLE StudentBio (
	BioID INT AUTO_INCREMENT,
	StudentID INT,
	Bio TEXT,
	FOREIGN KEY(StudentID) REFERENCES Student(StudentID) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY(BioID)
) ENGINE = INNODB;

CREATE TABLE Booking (
	RoomID INT,
	GroupID INT,
	Start DATETIME,
	Duration INT,
	FOREIGN KEY(RoomID) REFERENCES Room(RoomID) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(GroupID) REFERENCES ModuleGroup(GroupID) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY(Start)
) ENGINE = INNODB;

CREATE TABLE NonAvailability (
	Start LONG,
	StaffID INT,
	Duration INT,
	FOREIGN KEY(StaffID) REFERENCES Staff(StaffID) ON UPDATE CASCADE ON DELETE CASCADE,
	PRIMARY KEY (Start)
) ENGINE = INNODB;
